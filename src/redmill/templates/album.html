{% set images = {"album": "folder", "media": "image"} %}
{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
    <section id="metadata">
        <form>
            {% for id_, (label, element, attributes, content, close, after) in metadata %}
                {% if label %}<label for="{{ id_|safe }}">{{ label }}</label>{% endif -%}
                <{{ element}} id="{{ id_ }}" {% for name, value in attributes.items() %}{{ name }}="{{ value }}" {% endfor %}>
                {{- content -}}
                {%- if close %}</{{ element }}>{% endif -%}
                {{ after|safe }}
            {% endfor %}

            {% for id_, (element, attributes, after) in buttons %}
                <{{ element}} id="{{ id_ }}" {% for name, value in attributes.items() %}{{ name }}="{{ value }}" {% endfor %}>
                {{ after|safe }}
            {% endfor %}
        </form>

        <ul>
            {% for href, content in creation_links %}
            <li><a href="{{ href }}">{{ content }}</a></li>
            {% endfor %}
        </ul>
    </section>

    <ul class="children">
    {% for child in children %}
        <li><a href="{{ url_for("{}.get".format(child.type), id_=child.id) }}"><i class="fa fa-{{ images[child.type] }} fa-lg"></i>&nbsp;{{ child.name }}</a></li>
    {% endfor %}
    </ul>

    <script src="{{ url_for("static", filename="item_form.js") }}"></script>
    <script>
        function main() {
            format_dates(["#created_at", "#modified_at"]);
            {% if url %}
            $("#submit").click(submit_item_form.bind(undefined, {{ send|tojson}}, {{ method|tojson }}, {{ url|tojson }}, null));
            $("#archive").click(archive_item.bind(undefined, {{ url|tojson }}));
            {% endif %}
            {% if delete_url %}
            $("#delete").click(delete_item.bind(undefined, {{ delete_url|tojson }}));
            {% endif %}
        }

        $(document).ready(function(event) { main() });
    </script>

{% endblock %}
